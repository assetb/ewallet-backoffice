 # Документация по файлам данных

Папка `backend/data` содержит файлы данных для системы электронного кошелька (eWallet). Все файлы используют текстовый формат с разделителем `;` (точка с запятой).

## Структура файлов

### 1. `users.txt` - Пользователи системы
**Назначение:** Хранение учетных данных пользователей системы с ролями доступа.

**Формат:**
```
userId;login;hashedPassword;role
```

**Поля:**
- `userId` - уникальный идентификатор пользователя (число)
- `login` - логин пользователя (строка)
- `hashedPassword` - хеш пароля в формате bcrypt
- `role` - роль пользователя: `manager`, `finance`, `supervisor`

**Пример:**
```
1;admin;$2b$10$rSNVJQWGn00c8ZOywANPmO9VhBf.gDvYxCdgRiTEF0pHgyn4BXv7y;manager
```

### 2. `merchants.txt` - Мерчанты
**Назначение:** Справочник мерчантов (торговых организаций) в системе.

**Формат:**
```
merchantId;merchantName
```

**Поля:**
- `merchantId` - уникальный идентификатор мерчанта (строка)
- `merchantName` - название мерчанта (строка)

**Пример:**
```
StablexSolution;ООО «Stablex Solution»
```

### 3. `redemption_requests.txt` - Запросы на погашение
**Назначение:** Хранение запросов на погашение средств от мерчантов.

**Формат:**
```
requestId;merchantId;amount;requesterId;dateTimeISO;status
```

**Поля:**
- `requestId` - уникальный идентификатор запроса (строка)
- `merchantId` - идентификатор мерчанта (строка)
- `amount` - сумма запроса (число)
- `requesterId` - идентификатор пользователя, создавшего запрос (число)
- `dateTimeISO` - дата и время создания запроса в формате ISO 8601
- `status` - статус запроса: `PENDING`, `APPROVED`, `REJECTED`, `COMPLETED`

### 4. `history.txt` - История операций
**Назначение:** Лог всех операций эмиссии и погашения средств.

**Формат:**
```
type;recordId;merchantId;amount;dateTimeISO
```

**Поля:**
- `type` - тип операции: `REDEMPTION` (погашение) или `EMISSION` (эмиссия)
- `recordId` - уникальный идентификатор записи (строка)
- `merchantId` - идентификатор мерчанта (строка)
- `amount` - сумма операции (число)
- `dateTimeISO` - дата и время операции в формате ISO 8601

### 5. `uploaded_files.txt` - Загруженные файлы
**Назначение:** Метаданные загруженных файлов с результатами обработки.

**Формат:**
```
filename;uploadDateTimeISO;uploaderId;status;processedRecords;totalRecords
```

**Поля:**
- `filename` - имя загруженного файла (строка)
- `uploadDateTimeISO` - дата и время загрузки в формате ISO 8601
- `uploaderId` - идентификатор пользователя, загрузившего файл (число)
- `status` - статус обработки: `PENDING`, `PROCESSING`, `COMPLETED`, `ERROR`
- `processedRecords` - количество обработанных записей (число)
- `totalRecords` - общее количество записей в файле (число)

**Пример:**
```
transaction_test.csv;2025-06-17T05:36:45.784Z;1;ERROR;0;1
```

## Правила работы с файлами

1. **Кодировка:** Все файлы должны быть в кодировке UTF-8
2. **Разделитель:** Используется точка с запятой (`;`) как разделитель полей
3. **Заголовки:** Первая строка каждого файла содержит комментарий с описанием формата
4. **Пустые строки:** Игнорируются при обработке
5. **Валидация:** Все данные должны проходить валидацию перед записью

## Безопасность

- Пароли хранятся только в виде bcrypt-хешей
- Доступ к файлам данных ограничен серверными процессами
- Рекомендуется регулярное резервное копирование файлов данных

